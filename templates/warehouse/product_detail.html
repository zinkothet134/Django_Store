{% extends "base.html" %}
{% load humanize %}
{% block content %}
<div class="container py-4">
<div class="row g-4">
  <!-- LEFT COLUMN : Product Info -->
  <div class="col-md-4">
    {% if product.images %}
      <figure style="margin:0;">
        <a href="{% url 'warehouse_scan' product.sku %}">
        <img src="{{ product.images.url }}"
             alt="{{ product.product_name }}"
             class="img-fluid rounded"
             style="max-height:250px; object-fit:cover;"></a>
      </figure>
    {% else %}
      <span class="text-muted">No Image</span>
    {% endif %}
      <div class="mt-3">
      <h4>{{ product.product_name }}</h4>
      <p><b>SKU Number:</b> {{ product.sku }}</p>
      <p><b>Stock:</b>
        {% if product.stock > 0 %}
          <span class="text-success">{{ product.stock }}</span>
        {% else %}
          <span class="text-danger">Out of stock</span>
        {% endif %}
      </p>
      <p><b>Unit Price:</b> MMK {{ product.price|intcomma }}</p>
      <a class="btn btn-primary btn-sm" href="{% url 'warehouse_scan' product.sku %}">Stock Invoices</a>
      <a class="btn btn-outline-primary btn-sm" href="{% url 'warehouse_print_qr' product.sku %}">Print QR</a>
    </div>
  </div>

    <!-- RIGHT COLUMN : Daily Movement Table -->
  <div class="col-md-8">
    <h5 class="mb-3">Daily Stock Movement (Last 30 Days)</h5>

      {% if daily_movements %}
      <div class="table-responsive">
        <table class="table table-bordered table-sm">
          <thead class="thead-light">
            <tr>
              <th>Date</th>
              <th class="text-success">IN</th>
              <th class="text-danger">OUT</th>
              <th>Net</th>
            </tr>
          </thead>
          <tbody>
            {% for d in daily_movements %}
              <tr>
                <td>{{ d.day|date:"Y-m-d" }}</td>
                <td class="text-success">{{ d.qty_in|default:0 }}</td>
                <td class="text-danger">{{ d.qty_out|default:0 }}</td>
                <td>
                  {% if d.net > 0 %}
                    <span class="text-success">+{{ d.net }}</span>
                  {% elif d.net < 0 %}
                    <span class="text-danger">{{ d.net }}</span>
                  {% else %}
                    <span class="text-muted">0</span>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="text-muted">No stock movement records yet.</p>
    {% endif %}
    </div>
  </div>
</div>
</div>
{% endblock %}